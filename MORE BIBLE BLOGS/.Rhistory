df %>%
# Remove rows with missing Gravida or Abortions
filter(!is.na(Gravida), !is.na(Abortions)) %>%
# Categorize Gravida and Abortions
mutate(
Gravida_cat = cut(
Gravida,
breaks = c(-1, 2, 4, 8),
labels = c("0–2", "3–4", "5–8")
),
Abortions_cat = cut(
Abortions,
breaks = c(-1, 0, 1, 4),
labels = c("0", "1", "≥2")
)
) %>%
# Count and compute percentages
count(Gravida_cat, Abortions_cat) %>%
group_by(Gravida_cat) %>%
mutate(perc = n / sum(n) * 100) %>%
# Plot
ggplot(aes(
x = Gravida_cat,
y = perc,
fill = Abortions_cat,
label = paste0(n, " (", round(perc, 1), "%)")
)) +
geom_col(position = "stack") +
geom_text(
position = position_stack(vjust = 0.5),
size = 4
) +
labs(
title = "Distribution of Abortions within Gravida Categories",
x = "Gravida Category",
y = "Percentage (%)",
fill = "Number of Abortions"
) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05))) +
theme_minimal(base_size = 14) +
theme(
axis.text = element_text(size = 12),
axis.title = element_text(size = 13),
plot.title = element_text(size = 15, face = "bold", hjust = 0.5),
legend.position = "right"
)
df %>%
# Remove rows with missing Gravida or Abortions
filter(!is.na(Gravida), !is.na(Abortions)) %>%
# Categorize Gravida and Abortions
mutate(
Gravida_cat = cut(
Gravida,
breaks = c(-1, 2, 4, 8),
labels = c("0–2", "3–4", "5–8")
),
Abortions_cat = cut(
Abortions,
breaks = c(-1, 0, 1, 4),
labels = c("0", "1", "≥2")
)
) %>%
# Count and compute percentages
count(Gravida_cat, Abortions_cat) %>%
group_by(Gravida_cat) %>%
mutate(perc = n / sum(n) * 100) %>%
# Plot
ggplot(aes(
x = Gravida_cat,
y = perc,
fill = Abortions_cat,
label = paste0(n, " (", round(perc, 1), "%)")
)) +
geom_col(position = "stack") +
geom_text(
position = position_stack(vjust = 0.5),
size = 4
) +
scale_fill_manual(
values = c(
"0" = "#2ECC71",   # Green for 0 abortions
"1" = "#3498DB",   # Blue for 1 abortion
"≥2" = "#E74C3C"   # Red for ≥2 abortions
)
) +
labs(
title = "Distribution of Abortions within Gravida Categories",
x = "Gravida Category",
y = "Percentage (%)",
fill = "Number of Abortions"
) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05))) +
theme_minimal(base_size = 14) +
theme(
axis.text = element_text(size = 12),
axis.title = element_text(size = 13),
plot.title = element_text(size = 15, face = "bold", hjust = 0.5),
legend.position = "right",
legend.title = element_text(size = 12),
legend.text = element_text(size = 11)
)
df %>%
# Remove rows with missing Gravida or Abortions
filter(!is.na(Gravida), !is.na(Abortions)) %>%
# Categorize Gravida and Abortions
mutate(
Gravida_cat = cut(
Gravida,
breaks = c(-1, 2, 4, 8),
labels = c("0–2", "3–4", "5–8")
),
Abortions_cat = cut(
Abortions,
breaks = c(-1, 0, 1, 4),
labels = c("0", "1", "≥2")
)
) %>%
# Count and compute percentages
count(Gravida_cat, Abortions_cat) %>%
group_by(Gravida_cat) %>%
mutate(perc = n / sum(n) * 100) %>%
# Plot
ggplot(aes(
x = Gravida_cat,
y = perc,
fill = Abortions_cat,
label = paste0(n, " (", round(perc, 1), "%)")
)) +
geom_col(position = "stack") +
geom_text(
position = position_stack(vjust = 0.5),
size = 4
) +
scale_fill_manual(
values = c(
"0" = "#2ECC71",   # Green for 0 abortions
"1" = "#3498DB",   # Blue for 1 abortion
"≥2" = "#E74C3C"   # Red for ≥2 abortions
)
) +
labs(
title = "Distribution of Abortions within Gravida Categories",
x = "Gravida Category",
y = "Percentage (%)",
fill = "Number of Abortions"
) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05))) +
theme_minimal(base_size = 14) +
theme(
axis.text = element_text(size = 12),
axis.title = element_text(size = 13, , face = "bold"),
plot.title = element_text(size = 15, face = "bold", hjust = 0.5),
legend.position = "right",
legend.title = element_text(size = 12, , face = "bold"),
legend.text = element_text(size = 11)
)
# Step 1: Prevalence summary
hpv_summary <- df %>%
summarise(
total = n(),
positive = sum(HPV_status == "Positive"),
prevalence = round((positive / total) * 100, 1)
)
hpv_summary
# Step 2: Distribution of HPV types
hpv_type_dist <- df %>%
count(HPV_clean) %>%
mutate(perc = round(100 * n / sum(n), 1))
hpv_type_dist
# Step 3: Cross-tabulation HPV status vs Dysplasia
tab_hpv_dysplasia <- table(df$HPV_status, df$Dysplasia)
tab_hpv_dysplasia
# Step 4: Fisher’s Exact or Chi-square test
if (any(tab_hpv_dysplasia < 5)) {
test_result <- fisher.test(tab_hpv_dysplasia)
} else {
test_result <- chisq.test(tab_hpv_dysplasia)
}
test_result
# Step 5: Odds Ratio (OR) with 95% CI
or_result <- oddsratio(tab_hpv_dysplasia)
library(dplyr)
library(gtsummary)
library(epitools)
# Step 1: Prevalence summary
hpv_summary <- df %>%
summarise(
total = n(),
positive = sum(HPV_status == "Positive"),
prevalence = round((positive / total) * 100, 1)
)
hpv_summary
# Step 2: Distribution of HPV types
hpv_type_dist <- df %>%
count(HPV_clean) %>%
mutate(perc = round(100 * n / sum(n), 1))
hpv_type_dist
# Step 3: Cross-tabulation HPV status vs Dysplasia
tab_hpv_dysplasia <- table(df$HPV_status, df$Dysplasia)
tab_hpv_dysplasia
# Step 4: Fisher’s Exact or Chi-square test
if (any(tab_hpv_dysplasia < 5)) {
test_result <- fisher.test(tab_hpv_dysplasia)
} else {
test_result <- chisq.test(tab_hpv_dysplasia)
}
test_result
# Step 5: Odds Ratio (OR) with 95% CI
or_result <- oddsratio(tab_hpv_dysplasia)
or_result
# Frequency table with percentages
pap_summary <- df %>%
count(PAP) %>%
mutate(perc = 100 * n / sum(n))
# Plot
ggplot(pap_summary, aes(x = PAP, y = n, fill = PAP, label = paste0(n, " (", round(perc, 1), "%)"))) +
geom_col(width = 0.7, color = "black") +
geom_text(vjust = -0.5, size = 5) +
scale_fill_manual(values = c(
"NILM" = "#2ECC71",  # Green
"ASCUS" = "#3498DB", # Blue
"ASC-H" = "#9B59B6", # Purple
"LSIL" = "#F1C40F",  # Yellow
"HSIL" = "#E67E22",  # Orange
"SCC" = "#E74C3C"    # Red
)) +
labs(
title = "Distribution of Pap Smear Results",
x = "Pap Smear Category",
y = "Number of Participants",
fill = "Pap Smear Result"
) +
theme_minimal(base_size = 14) +
theme(
axis.text.x = element_text(size = 12, angle = 25, hjust = 1),
axis.text.y = element_text(size = 12),
axis.title = element_text(size = 13),
plot.title = element_text(size = 15, face = "bold", hjust = 0.5),
legend.position = "none"
)
library(ggplot2)
library(dplyr)
# Prepare and sort data
pap_summary <- df %>%
count(PAP) %>%
mutate(perc = 100 * n / sum(n)) %>%
arrange(desc(n)) %>%
mutate(PAP = factor(PAP, levels = PAP))  # preserve sorted order
# Plot
ggplot(pap_summary, aes(x = PAP, y = n, fill = PAP,
label = paste0(n, " (", round(perc, 1), "%)"))) +
geom_col(width = 0.7, color = "black") +
geom_text(hjust = -0.1, size = 5) +
coord_flip() +  # Make horizontal
scale_fill_manual(values = c(
"NILM" = "#2ECC71",   # Green for normal
"ASCUS" = "#3498DB",  # Blue for ASCUS
"ASC-H" = "#9B59B6",  # Purple
"LSIL" = "#F1C40F",   # Yellow
"HSIL" = "#E67E22",   # Orange
"SCC" = "#E74C3C"     # Red for SCC
)) +
labs(
title = "Distribution of Pap Smear Results",
x = NULL,
y = "Number of Participants",
fill = "Pap Smear Result"
) +
scale_y_continuous(expand = expansion(mult = c(0, 0.1))) +
theme_minimal(base_size = 14) +
theme(
axis.text = element_text(size = 12),
axis.title = element_text(size = 13),
plot.title = element_text(size = 15, face = "bold", hjust = 0.5),
legend.position = "none"
)
# Compute HPV prevalence
hpv_prev <- df %>%
count(HPV_status) %>%
mutate(
perc = 100 * n / sum(n),
label = paste0(HPV_status, "\n", n, " (", round(perc, 1), "%)")
)
hpv_prev
ggplot(hpv_prev, aes(x = "", y = perc, fill = HPV_status)) +
geom_col(color = "white", width = 1) +
coord_polar(theta = "y") +
geom_text(aes(label = label),
position = position_stack(vjust = 0.5),
color = "white", size = 5, fontface = "bold") +
scale_fill_manual(values = c("Positive" = "#E74C3C", "Negative" = "#2ECC71")) +
labs(
title = "Prevalence of High-Risk HPV among Screened Women",
fill = "HPV Status"
) +
theme_void(base_size = 14) +
theme(
plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
legend.position = "none"
)
library(dplyr)
library(gtsummary)
library(epitools)
# Step 1: Prevalence summary
hpv_summary <- df %>%
summarise(
total = n(),
positive = sum(HPV_status == "Positive"),
prevalence = round((positive / total) * 100, 1)
)
hpv_summary
# Step 2: Distribution of HPV types
hpv_type_dist <- df %>%
count(HPV_clean) %>%
mutate(perc = round(100 * n / sum(n), 1))
hpv_type_dist
# Step 3: Cross-tabulation HPV status vs Dysplasia
tab_hpv_dysplasia <- table(df$HPV_status, df$Dysplasia)
tab_hpv_dysplasia
# Step 4: Fisher’s Exact or Chi-square test
if (any(tab_hpv_dysplasia < 5)) {
test_result <- fisher.test(tab_hpv_dysplasia)
} else {
test_result <- chisq.test(tab_hpv_dysplasia)
}
test_result
# Step 5: Odds Ratio (OR) with 95% CI
or_result <- oddsratio(tab_hpv_dysplasia)
or_result
library(ggplot2)
hpv_summary <- df %>%
count(HPV_status) %>%
mutate(perc = n / sum(n) * 100)
ggplot(hpv_summary, aes(x = "", y = perc, fill = HPV_status)) +
geom_bar(width = 1, stat = "identity") +
coord_polar("y", start = 0) +
geom_text(aes(label = paste0(round(perc, 1), "%")),
position = position_stack(vjust = 0.5), size = 5, color = "white") +
scale_fill_manual(values = c("Positive" = "#E74C3C", "Negative" = "#2ECC71")) +
theme_void() +
labs(title = "Prevalence of High-Risk HPV Types",
fill = "HPV Status")
# Recode dependent variable for regression
df <- df %>%
mutate(
Dysplasia_bin = ifelse(Dysplasia == "Abnormal", 1, 0),
HPV_bin = ifelse(HPV_status == "Positive", 1, 0)
)
# Simple (unadjusted) logistic regression
model1 <- glm(Dysplasia_bin ~ HPV_bin, data = df, family = binomial)
# Adjusted logistic regression (include age and parity)
model2 <- glm(Dysplasia_bin ~ HPV_bin + AGE + Parity_num,
data = df, family = binomial)
# Summaries
summary(model1)
summary(model2)
# Compute Odds Ratios and 95% CI
library(broom)
results <- tidy(model2, exponentiate = TRUE, conf.int = TRUE)
results
library(dplyr)
library(ggplot2)
library(broom)
library(gtsummary)
# Descriptive summary
table_age_hpv <- df %>%
group_by(age_cat, HPV_status) %>%
summarise(n = n()) %>%
mutate(percent = n / sum(n) * 100)
library(dplyr)
library(ggplot2)
library(broom)
library(gtsummary)
# Descriptive summary
table_age_hpv <- df %>%
group_by(Age_cat, HPV_status) %>%
summarise(n = n()) %>%
mutate(percent = n / sum(n) * 100)
print(table_age_hpv)
# Chi-square test
tab_age <- table(df$Age_cat, df$HPV_status)
chisq.test(tab_age)
# Logistic regression (HPV positivity as outcome)
# df <- df %>%
#   mutate(HPV_bin = ifelse(HPV_status == "Positive", 1, 0))
model_age <- glm(HPV_bin ~ AGE, data = df, family = binomial)
summary(model_age)
# Compute Odds Ratios and 95% CI
results_age <- tidy(model_age, exponentiate = TRUE, conf.int = TRUE)
results_age
# Logistic regression (HPV positivity as outcome)
# df <- df %>%
#   mutate(HPV_bin = ifelse(HPV_status == "Positive", 1, 0))
model_age <- glm(HPV_bin ~ Age_cat, data = df, family = binomial)
summary(model_age)
# Compute Odds Ratios and 95% CI
results_age <- tidy(model_age, exponentiate = TRUE, conf.int = TRUE)
results_age
# Bar plot showing HPV prevalence by age category
ggplot(table_age_hpv, aes(x = Age_cat, y = percent, fill = HPV_status)) +
geom_bar(stat = "identity", position = "dodge") +
geom_text(aes(label = paste0(round(percent, 1), "%")),
position = position_dodge(width = 0.9), vjust = -0.3, size = 4) +
scale_fill_manual(values = c("#4CAF50", "#F44336")) +
labs(
title = "Prevalence of High-Risk HPV by Age Category",
x = "Age Category (years)",
y = "Prevalence (%)",
fill = "HPV Status"
) +
theme_minimal(base_size = 13)
# Assuming you already have table_age_hpv with variables: Age_cat, HPV_status, n, percent
# If not, create it like this:
# table_age_hpv <- df %>%
#   group_by(Age_cat, HPV_status) %>%
#   summarise(n = n()) %>%
#   mutate(percent = n / sum(n) * 100)
# Bar plot with n (%)
ggplot(table_age_hpv, aes(x = Age_cat, y = percent, fill = HPV_status)) +
geom_bar(stat = "identity", position = position_dodge(width = 0.9), width = 0.75) +
geom_text(
aes(label = paste0(n, " (", round(percent, 1), "%)")),
position = position_dodge(width = 0.9),
vjust = -0.3,
size = 4.5,
fontface = "bold"
) +
scale_fill_manual(values = c("#4CAF50", "#F44336")) +
labs(
title = "Prevalence of High-Risk HPV by Age Category",
x = "Age Category (years)",
y = "Prevalence (%)",
fill = "HPV Status"
) +
theme_minimal(base_size = 15) +
theme(
plot.title = element_text(size = 17, face = "bold", hjust = 0.5),
axis.title.x = element_text(size = 15, face = "bold"),
axis.title.y = element_text(size = 15, face = "bold"),
axis.text.x = element_text(size = 13, face = "bold", angle = 0, vjust = 1),
axis.text.y = element_text(size = 13, face = "bold"),
legend.title = element_text(size = 14, face = "bold"),
legend.text = element_text(size = 13),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
library(gtsummary)
library(dplyr)
# Create Table 1: HPV status by age category with p-value
tbl_age_hpv <- df_clean %>%
select(Age_cat, HPV_status) %>%
tbl_summary(
by = Age_cat,                  # Group by age category
statistic = all_categorical() ~ "{n} ({p}%)",
missing = "no"
) %>%
add_p(test = all_categorical() ~ "chisq.test") %>%  # Add Chi-square p-value
modify_header(label ~ "**HPV Status**") %>%
modify_caption("**Table X. Association Between Age Category and High-Risk HPV Status**")
library(gtsummary)
library(dplyr)
# Create Table 1: HPV status by age category with p-value
tbl_age_hpv <- df %>%
select(Age_cat, HPV_status) %>%
tbl_summary(
by = Age_cat,                  # Group by age category
statistic = all_categorical() ~ "{n} ({p}%)",
missing = "no"
) %>%
add_p(test = all_categorical() ~ "chisq.test") %>%  # Add Chi-square p-value
modify_header(label ~ "**HPV Status**") %>%
modify_caption("**Table X. Association Between Age Category and High-Risk HPV Status**")
tbl_age_hpv
# Frequency of Pap smear results
table_pap <- df %>%
count(PAP) %>%
mutate(percent = 100 * n / sum(n))
# Cross-tabulation of Pap smear results vs HPV status
tab_pap_hpv <- df %>%
count(PAP, HPV_status) %>%
group_by(PAP) %>%
mutate(percent = 100 * n / sum(n)) %>%
ungroup()
# Display results
table_pap
tab_pap_hpv
ggplot(tab_pap_hpv, aes(x = reorder(PAP, -percent), y = percent, fill = HPV_status)) +
geom_bar(stat = "identity", position = "dodge") +
geom_text(aes(label = paste0(n, " (", round(percent, 1), "%)")),
position = position_dodge(width = 0.9), hjust = -0.1, size = 4) +
coord_flip() +
scale_fill_manual(values = c("#4CAF50", "#F44336")) +
labs(
title = "Distribution of Cytological Findings by High-Risk HPV Status",
x = "Pap Smear Category",
y = "Percentage (%)",
fill = "HPV Status"
) +
theme_minimal(base_size = 13) +
theme(axis.text = element_text(size = 12), axis.title = element_text(size = 14))
# Combine all abnormal categories
df <- df %>%
mutate(
Cytology_group = ifelse(PAP == "NILM", "Normal", "Abnormal")
)
# Create contingency table
tab_cytology <- table(df$HPV_status, df$Cytology_group)
# Fisher’s Exact Test (due to small counts)
fisher_result <- fisher.test(tab_cytology)
# View results
tab_cytology
fisher_result
